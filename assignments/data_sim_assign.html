<h2>Data simulation</h2>

DRAFT 
<p>
generate data with given properties: errors, patches, fractals, mathematical functions, particles, perturbed points
uncertainty, sensitivity analysis
surface with errors
perturbed points

<p>
Resources:
<ul>
    <li><a href="http://grass.osgeo.org/grass74/manuals/index.html">
GRASS GIS overview and manual</a>
    <li><a href="http://www.grassbook.org/">GRASS book</a>
</ul>

<p>
For animating in GRASS GIS 7, see the
<a href="https://www.youtube.com/watch?v=Pi1ESk9iPwk">video instructions</a> or
instructions for the
<a href="http://ncsu-geoforall-lab.github.io/grass-temporal-workshop/">
  Spatio-temporal data handling and visualization in GRASS GIS workshop
</a>


<h3>Start GRASS GIS</h3>
Start GRASS - click on GRASS icon or type<br>

<pre><code>
grass74
</code></pre>

<p>
In startup pannel set <b>GRASS GIS Database Directory</b> to path to datasets,
for example on MS Windows, <code>C:\Users\myname\grassdata</code>.<br>
For <b>GRASS Location</b> select nc_spm_08_grass7 (North Carolina, State Plane, meters) and
for <b>GRASS Mapset</b> create a new mapset (called e.g. HW2_data_simulation).<br>
Click <b>Start GRASS session</b>.

<p>
Change working directory:<br>
<em>Settings</em> > <em>GRASS working environment</em> > <em>Change working directory</em> > select/create any directory<br>
or type <code>cd</code> (stands for change directory) into the GUI
<em>Console</em> and hit Enter:
<pre><code>
cd
</code></pre>

<p>
Download all text files with color rules (see above)
to the selected directory. Now you can use the commands from the assignment requiring the text file
without the need to specify the full path to the file.

<h3>Geometry-based methods</h3>

<p>
Set region to small rural watershed area at 1m resolution

<pre><code>
g.region rural_1m -p
</code></pre>

<p>
Using map algebra we generate a tilted plane with 20% slope, slightly rotated and shifted 50m 
above the (0,0) plane. We cut off the plane at the crossection with elev_lid792_1m surface,
but let it protrude 2m to make it visible above the surface

<pre><code>
r.mapcalc "tiltplane = 0.02*row()+0.2*col()+50"
r.mapcalc "tiltpl_under = if(tiltplane &lt; elev_lid792_1m + 2,tiltplane,null())"
</code></pre>
<p>
Generate a plane that crosses the surface along the region diagonal with 10% tilt and protrudes 5m through
the elev_lid792_1m surface. Visualize the plane together with elev_lid792_1m in 3D.

<p>
In the lecture we have shown mathematical surface with hills and valleys generated using the following function

<pre><code>
r.mapcalc "waves = sin(0.4*row())+0.3*cos(col())+80"
</code></pre>

<p>
Using map algebra generate surface with hills, depressions or valleys that is different from the one shown in lecture,
but is close enough to the elev_lid792_1m surface that you can visualize them together in 3D

<h3>Stochastic-based methods</h3>
<p>
Investiagte impact of errors with different distributions on watershed and stream delineation using random surfaces.

<pre><code>
g.region rural_1m
r.univar elev_lid792_1m
r.surf.gauss out=gauss_m120_s2 mean=120.769 sigma=2
r.univar gauss_m120_s2
r.colors gauss_m120_s2 co=differences
r.univar gauss_m120_s2
r.univar elev_lid792_1m

r.surf.gauss out=gauss_m0_s03 mean=0. sigma=0.3
r.colors gauss_m0_s03 co=differences
r.mapcalc "elev_lidnoise = elev_lid792_1m + gauss_m0_s03"
r.colors elev_lidnoise co=elevation

r.surf.random out=random_0_20 min=0 max=20
r.surf.random out=random_0_03 min=0 max=0.3 everything is 0
r.colors random_0_20 co=differences
add legend with histogram

r.random.surface output=random_spatial_d10 distance=10
r.mapcalc "randsurfspat = (random_spatial_d30 - 127.312) * (0.3/254)"
r.mapcalc "elev_lidnoised30 = elev_lid792_1m + randsurfspat"
r.colors elev_lidnoised30 co=elevation
</code></pre>

<p>
Compare watersheds from elev_lidnoised30,elev_lidnoise and others

Compare properties of watersheds (or viewsheds) computed using USGS DEM, DEM with errors, fractal surface
write a script to compute topo parameters, watersheds and their stats and compare with real terrain 
- which dimension is the closest?  
<p>
Random fractal surfaces
<p>
First we generate two series of surfaces with dimension 2.01 to 2.9. The series shows creation of a fractal surface.
Register the series in temporal framework, assign the rasters a common color table and create an animation
<pre><code>
r.surf.fractal out=fractal_dem_d290 dim=2.90 n=10
r.info fractal_dem_d290

t.create output=fractal_dem_29 type=strds temporaltype=relative title="Fractal DEMs with d=2.9"
t.register input=fractal_dem_29 type=raster file=fractal_dem29_series.txt unit=year
fractal_dem_d290.1|1001
fractal_dem_d290.2|1002
fractal_dem_d290.3|1003
fractal_dem_d290.4|1004
fractal_dem_d290.5|1005
fractal_dem_d290.6|1006
fractal_dem_d290.7|1007
fractal_dem_d290.8|1008
fractal_dem_d290.9|1009
fractal_dem_d290.10|1010

t.rast.list in=fractal_dem_29
t.rast.colors in=fractal_dem_29 co=elevation

r.surf.fractal out=fractal_dem_d201 dim=2.01 n=10
r.info fractal_dem_d201
t.create output=fractal_dem_201 type=strds temporaltype=relative title="Fractal DEMs with d=2.01" desc="Fractal DEMs with d=2.01"
t.register input=fractal_dem_201 type=raster file=fractal_dem201_series.txt unit=year
t.rast.colors in=fractal_dem_201 co=elevation
<pre><code>

<p>
Generating data for model validation
generate random samples based on landcover
v.random - manual has the exmple from ESTCP erosion modeling project

<p>
create several landscape cover scenarios - compare how their shape and size will influence simple erosion index cls
prepare example for manual page
r.pi.nlm.circ - Creates a random landscape with defined attributes
r.pi.nlm: Creates a random generated map with values 0 or 1by given landcover and fragment count.
r.pi.nlm.stats: Neutral Landscape Generator - index statistics


